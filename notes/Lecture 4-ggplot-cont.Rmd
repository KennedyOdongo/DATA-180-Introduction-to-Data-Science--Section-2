---
title: "HW 2: ggplot"
subtitle: "Data 180, Professor Bilen"
author: 
  name: "XXXX"
  email: "XXXX@dickinson.edu"
date: '`r format(Sys.Date(), "%B %d, %Y")`' # no need to change date since this line grabs today's date
output: 
  html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Theme of the assignment:
Let's practice visualization using ggplot2 and maps. Load in the `Cars93` dataset by running the following code chunk:

```{r}
library(ggplot2)
library(MASS)
data(Cars93)
```

## Task 1a
Create a simple scatterplot using ggplot2 where x axis shows `EngineSize`, y axis shows `MPG.city`.

* Use blue color for your dots.
* Use size = 2 for the dot sizes.
* Use xlim and ylim to make sure your x and y axis ranges make sense.
* Add a title, subtitle, x axis label, y axis label, and a caption.
 
```{r}
library(ggplot2)
ggplot(Cars93, aes(x=Weight,y=MPG.city)) + 
                geom_point(aes(color=Type)) +
                geom_smooth(method=lm, se=F,color='red',linetype = "dashed") 
```

## Task 1b
Recreate the scatterplot in Task 1. Add the following functionality:

* Use a different color for each car `Type` category.

## Task 1c
Recreate the scatterplot in Task 2. Add the following functionality:

* Fit and display a linear regression line.
* Make the regression line red, and dashed. (Hint linetype is the option you can use to set line style as dashed)

## Task 2a
Create a barplot showing `AirBags` frequency using ggplot2.

* Use a different color for each bar.
* Add a title, subtitle, x axis label, y axis label, and a caption.

```{r}
ggplot(Cars93,aes(x=AirBags)) +
      geom_bar(aes(fill=AirBags))
```

## Task 2b
Recreate the barplot in Task 2a for different car `Origin`, such that you create one barplot for each `Origin` category.
```{r}
ggplot(Cars93,aes(x=Origin)) +
      geom_bar(aes(fill=AirBags),position='dodge')
```

## Task 3a
Load Australia state map data via running:
```{r}
# install the packages below by uncommenting the lines. You need to do this only once.
#install.packages('maps')
#install.packages('ozmaps')
#install.packages('sf')
library(maps)
library(ozmaps)
library(sf)
oz_states <- ozmaps::ozmap_states

# Display the data
head(oz_states)
```

## Task 3a
Create a map of Australia using ggplot.
```{r}
ggplot(oz_states) + 
  geom_sf()
```

## Task 3b
Modify your map such that each state is displayed with a different color. (Hint: use the fill option as an aes setting.)
```{r}
ggplot(oz_states) + 
  geom_sf(aes(fill = NAME))
```
## Task 3c
Read in the capital city dataframe by running:
```{r}
oz_capitals <- tibble::tribble( 
  ~city,           ~lat,     ~lon,
  "Sydney",    -33.8688, 151.2093,  
  "Melbourne", -37.8136, 144.9631, 
  "Brisbane",  -27.4698, 153.0251, 
  "Adelaide",  -34.9285, 138.6007, 
  "Perth",     -31.9505, 115.8605, 
  "Hobart",    -42.8821, 147.3272, 
  "Canberra",  -35.2809, 149.1300, 
  "Darwin",    -12.4634, 130.8456, 
)
```

Display the capitals as points on your map from Task 3a. (Hint: combine geom_sf() with geom_point())

```{r}
ggplot() + 
  geom_sf(data = oz_states, colour = "black", fill = NA) + 
  geom_point(data = oz_capitals, aes(x = lon, y = lat), col = "red", size=2)
```


## Task 3d
Let's take a look at different projection output. Change your map's projection to epsg 3112 by adding + coord_sf(). Recall the option that goes inside is st_crs(4_digit_code)
```{r}
ggplot(oz_states) + geom_sf()
ggplot(oz_states) + geom_sf() + coord_sf(crs = st_crs(3112))
```

## Task 3e
Lastly, let's display the same map using mapview()

```{r}
#install.packages('mapview')
library(mapview)
mapview(oz_states)
# you can use the mapview options to turn off legends, hover etc: legend = FALSE, label = FALSE, popup = FALSE
```

## Task 3f
Let's display the capitals on the map like before. First conver the `oz_capitals` dataframe to spatial dataframe object:
```{r}
capitals_geo <- st_as_sf(oz_capitals, coords = c("lon", "lat"))
```

Now add the new spatial capitals object via +

```{r}
mapview(oz_states) + mapview(capitals_geo,col.regions='red',legend=F)
```